DBEG.namespace("DBEG.portletManager"),DBEG.portletManager=function(e){"use strict";return{activePortletID:null,oneFiveLayerFor3BEGPortlet:null,activePortletName:null,selectValue:"",noDropdownUpdate:!0,menuButtonSelector:"",hideDropdownOptions:!1,possibleSelectValues:{},subscribeHideToken:null,subscribeCloseToken:null,init:function(){DBEG.namespace("DBEG.portletManager");this.activePortletID=null,this.oneFiveLayerFor3BEGPortlet=null,this.activePortletName=null,this.selectValue="",this.menuButtonSelector=".db-hover-dropdown-wrapper",this.possibleSelectValues={}},reInit:function(){this.activePortletID=null,this.activePortletName=null,this.selectValue="",this.oneFiveLayerFor3BEGPortlet=null,this.menuButtonSelector=".db-hover-dropdown-wrapper"},setIgnoreNextDropdownEnabling:function(){this.hideDropdownOptions=!0},addPortletManagerIdToSelectOptionMapping:function(e,t){this.possibleSelectValues[e]=t},setActivePortletTo:function(t,n,o){this.unsetActivePortlet();var i=this.comparePortletIDwithCurrentActive();return this.activePortletID=t,this.activePortletName=n,this.oneFiveLayerFor3BEGPortlet=null!=o?o:null,null!=e(this.menuButtonSelector)&&(e(".db-hover-dropdown-content").removeClass("hidden"),0==this.noDropdownUpdate&&(this.selectValue=this.possibleSelectValues[this.activePortletID],null!=this.selectValue&&(e(this.menuButtonSelector+" .db-hover-dropdown-item[data-value='"+this.selectValue+"']").addClass("db-selected"),this.hideDropdownOptions=!1),this.noDropdownUpdate=!0)),i},close3BEGOneFive:function(e){null!=this.oneFiveLayerFor3BEGPortlet&&("function"==typeof this.oneFiveLayerFor3BEGPortlet.onefive&&void 0!==this.oneFiveLayerFor3BEGPortlet.data("dbegOnefive")?this.oneFiveLayerFor3BEGPortlet.onefive("close",e):DBEG.log("oneFiveLayer in portletManager not initialized"))},getActivePortlet:function(){return this.activePortletName},comparePortletIDwithCurrentActive:function(e){return void 0!==DbitComponents&&void 0!==DbitComponents.OneFiveHandler&&!DbitComponents.OneFiveHandler.bwcCanIOpenOneFive()||null!=this.activePortletID&&e!=this.activePortletID},prepareClosingCurrentActivePortletWithCallback:function(e){null!=e&&null!=e&&e(),null!=this.oneFiveLayerFor3BEGPortlet?("function"==typeof this.oneFiveLayerFor3BEGPortlet.onefive&&void 0!==this.oneFiveLayerFor3BEGPortlet.data("dbegOnefive")?(this.oneFiveLayerFor3BEGPortlet.onefive("disableWarningBeforeClosing"),this.oneFiveLayerFor3BEGPortlet.onefive("close")):DBEG.log("oneFiveLayer in portletManager not initialized"),this.oneFiveLayerFor3BEGPortlet=null):DbitComponents.OneFiveHandler.bwcCanIOpenOneFive()||(DbitComponents.OneFiveHandler.setCurrentOneFiveDirtyStatus(!1),DbitComponents.OneFiveHandler.bwcCloseOneFive())},unsetActivePortlet:function(){this.activePortletID=null,this.oneFiveLayerFor3BEGPortlet=null,this.activePortletName=null,this.selectValue="",null!=e(this.menuButtonSelector)&&e(this.menuButtonSelector).find(".db-hover-dropdown-item").removeClass("db-selected")},closeCurrentlyOpenPortlet:function(e,t){var n=this;n.subscribeCloseToken&&PubSub.unsubscribe(n.subscribeCloseToken),void 0===DbitComponents||void 0===DbitComponents.OneFiveHandler||DbitComponents.OneFiveHandler.bwcCanIOpenOneFive()||DbitComponents.OneFiveHandler.bwcCloseOneFive().then(function(){e&&e()}).catch(function(e){}),null!=n.subscribeHideToken&&PubSub.unsubscribe(n.subscribeHideToken),n.subscribeHideToken=PubSub.subscribe(n.onCompleteHideMessageForActivePortlet(),function(){PubSub.unsubscribe(n.subscribeHideToken),e&&e()}),null!=this.oneFiveLayerFor3BEGPortlet&&(n.subscribeCloseToken=PubSub.subscribe(DBEG.WebShopConstants.EventConstants.ONE_FIVE_CLOSED,function(){PubSub.unsubscribe(n.subscribeCloseToken),PubSub.publish(n.hideMessageForActivePortlet())})),null==this.oneFiveLayerFor3BEGPortlet?PubSub.publish(n.hideMessageForActivePortlet()):this.close3BEGOneFive(t)},cancelClosingCallback:function(){this.subscribeHideToken&&PubSub.unsubscribe(this.subscribeHideToken)},enableClosingWarningForOneFive:function(){this.oneFiveLayerFor3BEGPortlet&&this.oneFiveLayerFor3BEGPortlet.onefive("setFormDirty")},hideMessageForActivePortlet:function(){return null!=this.oneFiveLayerFor3BEGPortlet?DBEG.WebShopConstants.EventConstants.EVENT_HIDE_PORTLET+this.activePortletName:DBEG.WebShopConstants.EventConstants.TAIKO_EVENT_HIDE_PORTLET+this.activePortletName},showMessageForActivePortlet:function(){return null!=this.oneFiveLayerFor3BEGPortlet?DBEG.WebShopConstants.EventConstants.EVENT_LOAD_PORTLET+this.activePortletName:DBEG.WebShopConstants.EventConstants.TAIKO_EVENT_LOAD_PORTLET+this.activePortletName},onCompleteHideMessageForActivePortlet:function(){return DBEG.WebShopConstants.EventConstants.EVENT_PORTLET_HIDDEN+this.activePortletName},onDropdownClick:function(t){if(!e(t.clickedItem).hasClass("db-selected")){e(".db-hover-dropdown-content").addClass("hidden");var n=PubSub.subscribe("dbTipsyCancel",function(){PubSub.unsubscribe(n),e(".db-hover-dropdown-content").removeClass("hidden")}),o=e(t.clickTarget);this.onTriggerClick(o),o.trigger("click")}},onTaikoTriggerClick:function(t){this.onTriggerClick(e(t))},onTriggerClick:function(e){null==e.data("event")&&"new-transaction"!==e.attr("id")||(e.hasClass("js-one-five-trigger")||"new-transaction"===e.attr("id")?this.noDropdownUpdate=!1:this.noDropdownUpdate=!0)},bwcCanIOpenOneFive:function(){return null===this.activePortletID},bwcIsAnyOneFiveOpend:function(){return void 0!==DbitComponents&&void 0!==DbitComponents.OneFiveHandler&&!DbitComponents.OneFiveHandler.bwcCanIOpenOneFive()||null!=this.activePortletID},bwcCloseOneFive:function(e){this.closeCurrentlyOpenPortlet(function(){e&&e()})}}}(jQuery);