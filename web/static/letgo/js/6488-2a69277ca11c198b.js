(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6488],{96488:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return Z}});var r=s(57437),a=s(50530),n=s(6063),i=s(403),l=s(47907),c=s(2265),o=s(39089),u=s.n(o),h=s(62220),d=s(16046);let g={searchHistory:"searchHistory",searchLength:10,typeCategories:"category",typeBrand:"brand",typePhrase:"phrase"};var p=s(60582),y=s(93085),f=s(56505);let{getRequest:m}=(0,p.F)(y.Z),v=async e=>await m(f.Z.suggestions,e),x=async()=>await m(f.Z.category.popular);var j=s(77089);function S(e){let{onItemClick:t}=e,[s,a]=(0,c.useState)(),[n,l]=(0,c.useState)(!0),o=(0,c.useRef)(!0),u=async()=>{a((await x()).data),l(!1)};(0,c.useEffect)(()=>{!0===o.current&&(o.current=!1,u())},[]);let p=e=>{if(e.entity_type===g.typeCategories){var t;return(0,j.Fy)(e.extra_params.url_path,null===(t=e.id)||void 0===t?void 0:t.toString())}return"#"};return(0,r.jsxs)("div",{className:"popularCategoriesWrapper",children:[(0,r.jsx)("span",{className:"pcTitle",children:h.suggestions.popularCategories}),(0,r.jsx)("div",{className:"popularCategories-items ".concat(n?"popularCategories-items-hidden":""),children:null==s?void 0:s.map(e=>(0,r.jsxs)(d.p,{onClick:t,href:p(e),children:[(0,r.jsx)(i.Z,{className:"searchTrigger",icon:e.icon,size:"16"}),e.title]},"suggestion-popular-category@".concat(e.id)))})]})}var k=s(24683),C=e=>{let{value:t,onChange:s,onFocus:a,onEnter:n}=e;return(0,r.jsx)("input",{type:"text",placeholder:h.layout.header.placeholderSearch,className:"searchTb",value:t,onChange:s,onClick:a,onFocus:a,onKeyDown:n})},_=s(55504),N=s(2733),w=s(72831),b=s(93350),E=s(40939);function Z(){let e=(0,l.useRouter)(),t=(0,l.useSearchParams)(),[s,o]=(0,c.useState)(""),[h,p]=(0,c.useState)(!1),[y,f]=(0,c.useState)(!1),[m,x]=(0,c.useState)(),[Z,I]=(0,c.useState)(null),[L,H]=(0,c.useState)([]),P=t.get("query_text")||"",T=(0,N.Z)(),F=e=>{let t=(e.categories||[]).slice(0,3),s=(e.brands||[]).slice(0,2),r=(e.phrases||[]).slice(0,2),a=7-(t.length+s.length+r.length);if(a>0){if(t.length<3){let s=e.categories.slice(3,3+a);t.push(...s),a-=s.length}if(a>0&&s.length<2){let t=e.brands.slice(2,2+a);s.push(...t),a-=t.length}if(a>0){let t=e.phrases.slice(2,2+a);r.push(...t)}}return[...t,...s,...r].slice(0,7)},O=(0,c.useCallback)(async e=>{try{p(!0);let t=await v({q:e});if(t.success&&t.data){let e=t.data.suggestions,s=F(e);H(s),(0,b.I)("search_complete",{listing_count:s.length,search_keyword:"search keyword",search_type:"popular categories, recent search, keyword search keyword"})}}catch(e){console.error("Error while fetching suggestions on header",e)}finally{p(!1)}},[]),z=(0,c.useCallback)(e=>{e&&O(e)},[O]),B=(0,c.useMemo)(()=>(0,w.Z)(z,500),[z]),R=()=>{f(!1),I(null)},q=()=>{f(!0),I(null)},J=e=>{let{value:t}=e.target;f(!0),o(t),B(t)},M=()=>{f(!1)},W=()=>{x(JSON.parse(localStorage.getItem(g.searchHistory)||"[]"))},A=e=>{var t,s,r;return e.entity_type===g.typeCategories&&e.extra_params?(0,j.Fy)(null===(t=e.extra_params)||void 0===t?void 0:t.category_slug,(null===(s=e.extra_params)||void 0===s?void 0:s.category_id)||""):e.entity_type===g.typeBrand?"/arama/?filter=make:".concat(null===(r=e.extra_params)||void 0===r?void 0:r.brand_slug,"&isSearchCall=true"):e.entity_type===g.typePhrase?"/arama/?query_text=".concat(encodeURIComponent(e.title),"&isSearchCall=true"):"/arama/?query_text=".concat(e.title,"&isSearchCall=true")},D=e=>{let t=JSON.parse(localStorage.getItem(g.searchHistory)||"[]");t.some(t=>t.title===e.title)||(t.unshift(e),t.length>g.searchLength&&t.pop(),localStorage.setItem(g.searchHistory,JSON.stringify(t))),W()},U=async t=>{if(o(""),H([]),f(!1),t.entity_type===g.typeCategories&&t.extra_params){var s,r;let a=(0,j.Fy)(null===(s=t.extra_params)||void 0===s?void 0:s.category_slug,(null===(r=t.entity_id)||void 0===r?void 0:r.toString())||"");return D(t),e.push("".concat(a,"/?isSearchCall=true"))}return t.entity_type===g.typeBrand&&(D(t),e.push("/arama/?filter=make:".concat(t.title,"&isSearchCall=true"))),t.entity_type===g.typePhrase&&e.push("/".concat(t.title,"&isSearchCall=true")),e.push("/arama/?query_text=".concat(t.title,"&isSearchCall=true"))},K=async t=>(o(""),H([]),f(!1),D({title:t}),e.push("/arama/?query_text=".concat(t,"&isSearchCall=true"))),V=e=>{R(),U(e)},G=e=>{e.key===_.tt&&null!==Z&&y?L&&L.length>0?(D(L[Z]),V(L[Z])):m&&m.length>0?U(m[Z]):K(s):e.key===_.tt&&K(s)},Q=(e,t)=>{e.preventDefault(),e.stopPropagation();let s=JSON.parse(localStorage.getItem(g.searchHistory)||"[]"),r=s.findIndex(e=>e.title===t.title);r>-1&&s.splice(r,1),localStorage.setItem(g.searchHistory,JSON.stringify(s)),x(s),f(!0)},X=()=>{localStorage.setItem(g.searchHistory,JSON.stringify([])),x([]),f(!0)},Y=(0,c.useCallback)(e=>{L&&L.length>0?e.key===_.P9?I(e=>null===e||e===L.length-1?0:e+1):e.key===_.HI&&I(e=>null===e||0===e?null:e-1):m&&m.length>0&&(e.key===_.P9?I(e=>null===e||e===m.length-1?0:e+1):e.key===_.HI&&I(e=>null===e||0===e?null:e-1))},[m,L]);return(0,c.useEffect)(()=>{W()},[]),(0,c.useEffect)(()=>{o(P)},[P]),(0,c.useEffect)(()=>{s||H([])},[s]),(0,c.useEffect)(()=>(window.addEventListener("keydown",Y),I(null),()=>{window.removeEventListener("keydown",Y)}),[L,m,Y]),(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"searchWrapper ".concat(y?"onFocus":""),children:[(0,r.jsx)(i.Z,{icon:"search",size:"24"}),(0,r.jsx)("div",{className:"searchContainer",children:(0,r.jsxs)(k.Z,{onClose:R,children:[(0,r.jsx)(C,{value:s,onChange:J,onFocus:q,onEnter:G}),y&&(0,r.jsxs)("div",{className:"suggestionWrapper",children:[h&&(0,r.jsx)(n.Z,{className:"suggestion-loader",position:"absolute"}),"mobile"===T&&(0,r.jsxs)("div",{className:"customMobileSearch",children:[(0,r.jsx)("div",{className:"backWrapper",onClick:()=>M(),children:(0,r.jsx)(i.Z,{icon:"back",size:"24"})}),(0,r.jsx)(C,{value:s,onChange:J,onFocus:q,onEnter:G}),(0,r.jsx)(i.Z,{icon:"search",size:"24"})]}),(0,r.jsx)("div",{className:"suggestion-container",children:(null==L?void 0:L.length)?L.map((e,t)=>(0,r.jsxs)(d.p,{href:A(e),className:"suggestion ".concat(t===Z?"active":""),onMouseEnter:()=>I(t),onClick:()=>{R(),D(e)},children:[(0,r.jsxs)("div",{className:"suggestionLeft",children:[(0,r.jsx)("div",{children:(0,r.jsx)(u(),{activeClassName:"suggestion-title",activeIndex:t,searchWords:s.split(/\s/).filter(e=>e),highlightClassName:"highlight",textToHighlight:e.title,unhighlightClassName:"suggestion-title",children:e.title})}),(0,r.jsx)("div",{children:(0,r.jsx)("span",{className:"suggestion-subtitle mt-1",children:e.sub_title&&e.sub_title})})]}),(0,r.jsxs)("div",{className:"suggestionRight",children:[e.entity_type===g.typeCategories&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.Z,{icon:"categories",size:"20"}),(0,r.jsx)("span",{className:"suggestionType",children:(0,E.i)("suggestions.category")})]}),e.entity_type===g.typeBrand&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.Z,{icon:"priceTag",size:"22"}),(0,r.jsx)("span",{className:"suggestionType",children:(0,E.i)("suggestions.brand")})]})]})]},t)):(0,r.jsxs)(r.Fragment,{children:[m&&m.length>0&&(0,r.jsxs)("div",{className:"lastSearchsWrapper",children:[(0,r.jsxs)("div",{className:"lastSearchHead",children:[(0,r.jsx)("span",{className:"lastSearchTitle",children:(0,E.i)("suggestions.lastSearchesTitle")}),(0,r.jsx)(a.ZP,{type:"flat",className:"clearLastSearch",onClick:()=>X(),children:(0,E.i)("suggestions.clear")})]}),(0,r.jsx)("div",{className:"lastSearchList",children:m.map((e,t)=>{let s="hot";switch(e.entity_type){case g.typeCategories:s="categories";break;case g.typeBrand:s="priceTag";break;default:s="hot"}return(0,r.jsxs)(d.p,{href:A(e),onClick:R,className:t===Z?"active":"",onMouseEnter:()=>I(t),children:[(0,r.jsxs)("span",{className:"lastSearchValue",children:[(0,r.jsx)(i.Z,{icon:s,size:"16"}),e.title]}),(0,r.jsx)("div",{className:"removeCurrentHistorySearch",onClick:t=>Q(t,e),children:(0,r.jsx)(i.Z,{icon:"cross",size:"14"})})]},t)})})]}),(0,r.jsx)(S,{onItemClick:R})]})})]})]})})]})})}s(77011)},16046:function(e,t,s){"use strict";s.d(t,{p:function(){return n}});var r=s(57437),a=s(8792);let n=(0,s(2265).forwardRef)(function(e,t){let{isExternalUrl:s,...n}=e;return(0,r.jsx)(a.default,{...n,ref:t,target:s?"_blank":void 0,rel:s?"noopener noreferrer":void 0,prefetch:!1})})},24683:function(e,t,s){"use strict";var r=s(57437),a=s(2265);t.Z=e=>{let{selfClass:t,children:s,onClose:n,targetClass:i,excludeClass:l}=e,c=(0,a.useRef)(null);return(0,a.useEffect)(()=>{let e=e=>{if(c.current){if(i){!c.current.contains(e.target)&&e.target.classList.contains(i)&&n();return}if(!c.current.contains(e.target)){if(l&&e.target.classList.contains(l))return;n()}}},t=e=>{"Escape"===e.key&&n()};return document.addEventListener("mousedown",e),document.addEventListener("keydown",t),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("keydown",t)}},[l,n,i]),(0,r.jsx)("div",{className:"outside-listener ".concat(t||""),ref:c,children:s})}},55504:function(e,t,s){"use strict";s.d(t,{HI:function(){return n},P9:function(){return a},tt:function(){return r}});let r="Enter",a="ArrowDown",n="ArrowUp"},72831:function(e,t,s){"use strict";function r(e,t){let s=0;return function(){for(var r=arguments.length,a=Array(r),n=0;n<r;n++)a[n]=arguments[n];let i=new Date().getTime();if(!(i-s<t))return s=i,e(...a)}}s.d(t,{P:function(){return r}}),t.Z=(e,t)=>{let s;return function(){for(var r=arguments.length,a=Array(r),n=0;n<r;n++)a[n]=arguments[n];clearTimeout(s),s=setTimeout(()=>e(...a),t)}}},93350:function(e,t,s){"use strict";s.d(t,{I:function(){return i},Z0:function(){return a},ob:function(){return n}});let r=e=>{window.dataLayer&&window.dataLayer.push(e)},a=e=>{r({event:"pageview",page:e})},n=(e,t)=>{r({event:"click",category:e,label:t})},i=(e,t)=>{r({device_id:"",user_id:"",platform:"",event:e,...t})}},40939:function(e,t,s){"use strict";s.d(t,{i:function(){return a}});var r=s(62220);let a=(e,t)=>{try{let s=e.split("."),a=r;for(let t of s){if("string"==typeof a||!(t in a))throw Error("Translation key not found: ".concat(e));a=a[t]}if("string"==typeof a){if(t)for(let e of Object.keys(t)){let s=RegExp("{".concat(e,"}"),"g");a=a.replace(s,String(t[e]))}return a}throw Error("Expected a string at path: ".concat(e,", but got an object."))}catch(t){return console.error(t),e}}},2733:function(e,t,s){"use strict";var r=s(2265);t.Z=()=>{let[e,t]=(0,r.useState)("");return(0,r.useEffect)(()=>{let{userAgent:e}=navigator;/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)?t("mobile"):/iPad/i.test(e)?t("tablet"):t("desktop")},[]),e}},77011:function(){}}]);