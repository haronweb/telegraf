/*! widget-3fb33864f63959e59e5b */!function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="./",i(i.s="tjUo")}({"/u0l":function(e,t){Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var i=Object(this),n=i.length>>>0;if(0===n)return!1;for(var r=0|t,o=Math.max(r>=0?r:n-Math.abs(r),0);o<n;){if(function(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)}(i[o],e))return!0;o++}return!1}})},"4fRq":function(e,t){var i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(i){var n=new Uint8Array(16);e.exports=function(){return i(n),n}}else{var r=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),r[t]=e>>>((3&t)<<3)&255;return r}}},Bnag:function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},EbDI:function(e,t){e.exports=function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}},I2ZF:function(e,t){for(var i=[],n=0;n<256;++n)i[n]=(n+256).toString(16).substr(1);e.exports=function(e,t){var n=t||0,r=i;return[r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]]].join("")}},Ijbi:function(e,t){e.exports=function(e){if(Array.isArray(e)){for(var t=0,i=new Array(e.length);t<e.length;t++)i[t]=e[t];return i}}},MVZn:function(e,t,i){var n=i("lSNA");e.exports=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},r=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(i).filter((function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable})))),r.forEach((function(t){n(e,t,i[t])}))}return e}},RIqP:function(e,t,i){var n=i("Ijbi"),r=i("EbDI"),o=i("Bnag");e.exports=function(e){return n(e)||r(e)||o()}},W8MJ:function(e,t){function i(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}e.exports=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}},lSNA:function(e,t){e.exports=function(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}},lwsE:function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},p46w:function(e,t,i){var n,r;
/*!
 * JavaScript Cookie v2.2.0
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */!function(o){if(void 0===(r="function"==typeof(n=o)?n.call(t,i,t,e):n)||(e.exports=r),!0,e.exports=o(),!!0){var s=window.Cookies,a=window.Cookies=o();a.noConflict=function(){return window.Cookies=s,a}}}((function(){function e(){for(var e=0,t={};e<arguments.length;e++){var i=arguments[e];for(var n in i)t[n]=i[n]}return t}return function t(i){function n(t,r,o){var s;if("undefined"!=typeof document){if(arguments.length>1){if("number"==typeof(o=e({path:"/"},n.defaults,o)).expires){var a=new Date;a.setMilliseconds(a.getMilliseconds()+864e5*o.expires),o.expires=a}o.expires=o.expires?o.expires.toUTCString():"";try{s=JSON.stringify(r),/^[\{\[]/.test(s)&&(r=s)}catch(e){}r=i.write?i.write(r,t):encodeURIComponent(String(r)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=(t=(t=encodeURIComponent(String(t))).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent)).replace(/[\(\)]/g,escape);var l="";for(var c in o)o[c]&&(l+="; "+c,!0!==o[c]&&(l+="="+o[c]));return document.cookie=t+"="+r+l}t||(s={});for(var u=document.cookie?document.cookie.split("; "):[],d=/(%[0-9A-Z]{2})+/g,h=0;h<u.length;h++){var p=u[h].split("="),m=p.slice(1).join("=");this.json||'"'!==m.charAt(0)||(m=m.slice(1,-1));try{var g=p[0].replace(d,decodeURIComponent);if(m=i.read?i.read(m,g):i(m,g)||m.replace(d,decodeURIComponent),this.json)try{m=JSON.parse(m)}catch(e){}if(t===g){s=m;break}t||(s[g]=m)}catch(e){}}return s}}return n.set=n,n.get=function(e){return n.call(n,e)},n.getJSON=function(){return n.apply({json:!0},[].slice.call(arguments))},n.defaults={},n.remove=function(t,i){n(t,"",e(i,{expires:-1}))},n.withConverter=t,n}((function(){}))}))},tjUo:function(e,t,i){"use strict";i.r(t);i("/u0l");var n=i("MVZn"),r=i.n(n),o=i("lwsE"),s=i.n(o),a=i("W8MJ"),l=i.n(a),c=i("p46w"),u=i.n(c),d=i("xDdU"),h=i.n(d);var p=function(){};function m(e,t){var i=null;return function(){for(var n=this,r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];clearTimeout(i),i=setTimeout((function(){e.apply(n,o)}),t)}}var g=function(){function e(){s()(this,e)}return l()(e,[{key:"addCommon",value:function(){var e=document.getElementsByTagName("head")[0],t=document.createElement("style");t.id="uxs-styles",t.appendChild(document.createTextNode("\n.uxs-loader {\n  width: 40px;\n  height: 40px;\n  position: absolute;\n  top: 45%;\n  left: 50%;\n  background-color: #333;\n  border-radius: 100%;\n  -webkit-animation: uxs-load 1.0s infinite ease-in-out;\n  animation: uxs-load 1.0s infinite ease-in-out;\n}\n\n.uxs-overlay {\n  position: fixed;\n  z-index: 1000000;\n  width: 100%;\n  height: 100%;\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n}\n\n@-webkit-keyframes uxs-load {\n  0% { -webkit-transform: scale(0) }\n  100% {\n    -webkit-transform: scale(1.0);\n    opacity: 0;\n  }\n}\n\n@keyframes uxs-load {\n  0% {\n    -webkit-transform: scale(0);\n    transform: scale(0);\n  } 100% {\n    -webkit-transform: scale(1.0);\n    transform: scale(1.0);\n    opacity: 0;\n  }\n}\n.uxs-back {\n  position: fixed;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  z-index: 999999;\n  overflow: auto;\n  background: rgba(0, 0, 0, 0.26);\n  -webkit-overflow-scrolling: touch;\n\n  height: 100%;\n  overflow: visible;\n  max-height: 100%;\n}\n\n.uxs-back iframe {\n  width: 100%;\n  height: 99%;\n  display: block;\n}\n\n.uxs-slide-back {\n  z-index: 999998;\n  overflow: auto;\n  height: 100%;\n  position: fixed;\n  opacity: 0;\n  -webkit-overflow-scrolling: touch;\n  overflow: visible;\n}\n\n.uxs-slide-back {\n  max-height: 100%;\n}\n\n.uxs-mobile-slide-back {\n  width: 100%;\n  overflow: auto;\n  overflow-x: hidden;\n}\n\n.uxs-slide-back.uxs-mobile-slide-back iframe {\n  display: block;\n  width: 87%;\n  margin-left: auto;\n}\n\n.uxs-slide-back.lowerLeft,\n.uxs-slide-back.upperRight,\n.uxs-slide-back.upperLeft,\n.uxs-slide-back.lowerRight {\n  opacity: 1;\n}\n\n.uxs-slide-back.lowerLeft {\n  left: 0;\n  bottom: 0;\n}\n.uxs-slide-back.upperRight {\n  right: 0;\n}\n.uxs-slide-back.upperLeft {\n  left: 0;\n}\n.uxs-slide-back.lowerRight {\n  right: 0;\n  bottom: 0;\n}\n\n.uxs-widget {\n  padding: 5px;\n  border: 2px solid red;\n  background-image : attr(data-src url);\n  background-size: cover;\n}\n\n.uxs-wrapper, .uxs-mobile-wrapper {\n  font-size: 0;\n  line-height: 0;\n}\n.uxs-wrapper img, .uxs-mobile-wrapper img {\n  display: block;\n}\n")),e.appendChild(t)}},{key:"clear",value:function(){var e=document.getElementsByTagName("head")[0],t=document.querySelector("#uxs-styles");e.removeChild(t)}}]),e}(),f={},v=window.navigator.userAgent.toLowerCase(),y=["googletv","viera","smarttv","internet.tv","netcast","nettv","appletv","boxee","kylo","roku","dlnadoc","pov_tv","hbbtv","ce-html"];function b(e){return-1!==v.indexOf(e)}f.macos=function(){return b("mac")},f.ios=function(){return f.iphone()||f.ipod()||f.ipad()},f.iphone=function(){return!f.windows()&&b("iphone")},f.ipod=function(){return b("ipod")},f.ipad=function(){return b("ipad")},f.android=function(){return!f.windows()&&b("android")},f.androidPhone=function(){return f.android()&&b("mobile")},f.androidTablet=function(){return f.android()&&!b("mobile")},f.blackberry=function(){return b("blackberry")||b("bb10")||b("rim")},f.blackberryPhone=function(){return f.blackberry()&&!b("tablet")},f.blackberryTablet=function(){return f.blackberry()&&b("tablet")},f.windows=function(){return b("windows")},f.windowsPhone=function(){return f.windows()&&b("phone")},f.windowsTablet=function(){return f.windows()&&b("touch")&&!f.windowsPhone()},f.fxos=function(){return(b("(mobile")||b("(tablet"))&&b(" rv:")},f.fxosPhone=function(){return f.fxos()&&b("mobile")},f.fxosTablet=function(){return f.fxos()&&b("tablet")},f.meego=function(){return b("meego")},f.mobile=function(){return f.androidPhone()||f.iphone()||f.ipod()||f.windowsPhone()||f.blackberryPhone()||f.fxosPhone()||f.meego()},f.tablet=function(){return f.ipad()||f.androidTablet()||f.blackberryTablet()||f.windowsTablet()||f.fxosTablet()},f.desktop=function(){return!f.tablet()&&!f.mobile()},f.tv=function(){for(var e=0;e<y.length;){if(b(y[e]))return!0;e++}return!1};var w=function(){return{desktop:f.desktop(),tablet:f.tablet(),mobile:f.mobile(),tv:f.tv(),iphone:f.iphone()}},k={API_URL:"https://public-api.uxfeedback.ru/v1",FORM_URL:"https://cdn3.uxfeedback.ru/1.1.21/form/index.html"};var x={id:null,type:null,matchedSeconds:null},S=function(){function e(){s()(this,e),this.uid=null,this.uidType=null,this.outer=null,this.wrapper=null,this.mobileWrapper=null,this.state=null,this.iframe=null,this.spinner=null,this.initedListener=!1,this.campaign=null,this.usedCampaign=null,this.styles=null,this.device=null,this.widgetForm=null,this.campaignForm=null,this.overlay=null,this.formHeight=null,this.widgetRenderTimeout=null,this.campaignTimeout=null,this.closeWidgetForm=this.closeWidgetForm.bind(this),this.closeCampaignForm=this.closeCampaignForm.bind(this),this.hideWidgetForm=this.hideWidgetForm.bind(this),this.hideCampaignForm=this.hideCampaignForm.bind(this),this.messageListenerFn=this.messageListenerFn.bind(this),this.onUnloadListener=this.onUnloadListener.bind(this),this.scrollPageListener=this.scrollPageListener.bind(this),this.onResize=this.onResize.bind(this),this.subscriber=this.subscriber.bind(this),this.updateWidgetData=this.updateWidgetData.bind(this),this.hashListener=this.hashListener.bind(this),this.renderDesktopWidget=this.renderDesktopWidget.bind(this),this.renderMobileWidget=this.renderMobileWidget.bind(this),this.destroyDesktopWidget=this.destroyDesktopWidget.bind(this),this.destroyMobileWidget=this.destroyMobileWidget.bind(this),this.getHashListener=this.getHashListener.bind(this),this.dateTime=(new Date/1e3).toFixed()}return l()(e,[{key:"getSiteId",value:function(){return window._uxsSettings&&window._uxsSettings.id}},{key:"createOuter",value:function(){var e=document.body,t=document.createElement("div"),i=e.childNodes[0];return i?e.insertBefore(t,i):e.appendChild(t),t}},{key:"createWrapper",value:function(){var e=document.createElement("div");return e.id="uxs_".concat(this.getSiteId()),e.classList.add("uxs-wrapper"),this.outer.appendChild(e),this.addWrapperStyles(e),e}},{key:"addWrapperStyles",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.state,n=i.position,r=i.mobile,o=e.style;if(o.zIndex=999,o.position="fixed",o.cursor="pointer",o.textAlign="right",t){var s="7px";o.bottom=0,1===r.position?o.left=s:2===r.position&&(o.right=s)}else{var a="23px";1===n&&(o.left=0),3===n&&(o.left=a),2===n&&(o.right=0),4===n&&(o.right=a),3!==n&&4!==n&&5!==n||(o.bottom=0),1!==n&&2!==n||(o.top="50%",o.MsTransform="translateY(-50%)",o.WebkitTransform="translateY(-50%)",o.transform="translateY(-50%)"),5===n&&(o.left="50%",o.MsTransform="translateX(-50%)",o.WebkitTransform="translateX(-50%)",o.transform="translateX(-50%)")}}},{key:"createMobileWrapper",value:function(){var e=document.createElement("div");return e.id="uxs_".concat(this.getSiteId(),"_m"),e.classList.add("uxs-mobile-wrapper"),this.outer.appendChild(e),this.addWrapperStyles(e,!0),e}},{key:"doesCampaignMatch",value:function(){if(null===this.campaign)return!1;var e=this.campaign.id;return p("doesCampaignMatch",this.campaign),!!e}},{key:"createIframe",value:function(e){var t,i,n,r,o,s,a,l={userId:this.getSiteId(),ymId:(n=document.cookie,r=n.indexOf("_ym_uid"),o=n.indexOf(";",r),s=n.length,a=-1===o?s:o,n.substring(r,a).replace("_ym_uid=","")),gaId:(t=document.cookie.match("(?:^|;)\\s*_ga=([^;]*)"),i=t?decodeURIComponent(t[1]).match(/(\d+\.\d+)$/):null,i?i[1]:null),object:e},c=document.createElement("iframe");this.doesCampaignMatch()&&(l.campaignId=this.campaign.id,this.saveVisit(this.campaign.id)),this.checkPreviewMode()?l.isPreview=!0:"widget"===e&&this.saveVisit(this.state.widgetCampaignId);var u=encodeURIComponent(JSON.stringify(l));return c.frameBorder="0",c.marginWidth="0",c.marginHeight="0",c.scrolling="no",c.style.position="relative",c.style.backgroundColor="transparent",c.src="".concat(k.FORM_URL,"?config=").concat(u),c}},{key:"getFormType",value:function(){return this.campaign&&this.campaign.type||1}},{key:"createOverlay",value:function(){var e=document.createElement("div");return e.className="uxs-overlay",e}},{key:"createForm",value:function(e){var t=this,i=this.checkMobileDevice(),n=this.getFormType(),r=document.createElement("div"),o={2:"uxs-slide-back",1:"uxs-back"},s=o[n]?o[n]:o.popup;return i&&r.classList.add("uxs-mobile-slide-back"),r.id="uxs_".concat(this.getSiteId(),"_form"),r.classList.add(s),1===n&&(this.spinner=document.createElement("div"),this.spinner.classList.add("uxs-loader"),r.appendChild(this.spinner),r.onclick=function(){t.campaignForm&&t.closeCampaignForm(),t.widgetForm&&t.closeWidgetForm()}),this.iframe=this.createIframe(e),r.appendChild(this.iframe),r}},{key:"hideWidgetForm",value:function(){this.widgetForm.style.display="none"}},{key:"hideCampaignForm",value:function(){this.campaignForm.style.display="none"}},{key:"closeWidgetForm",value:function(){this.overlay&&(this.overlay=null),this.outer.removeChild(this.widgetForm),this.widgetForm=null}},{key:"closeCampaignForm",value:function(){this.outer.removeChild(this.campaignForm),this.clearCampaign(),this.campaignForm=null}},{key:"receiveMessage",value:function(e){var t=e.data,i=t.type,n=t.payload;"hideForm"===i&&("widget"===n?this.hideWidgetForm:this.hideCampaignForm)();"close"===i&&("widget"===n?this.closeWidgetForm:this.closeCampaignForm)();"closePreview"===i&&("widget"===n?this.closeWidgetForm:this.closeCampaignForm)();if("requestInfo"===i){var r=window.screen,o=r.width,s=r.height,a=document.location.href,l=this.dateTime,c=this.checkMobileDevice(),u=this.device.iphone,d=document.documentElement.clientHeight,h=window.devicePixelRatio||1;this.sendMessage("sendInfo",{width:+(o*h).toFixed(),height:+(s*h).toFixed(),url:a,dateTime:l,isMobile:c,isIphone:u,innerHeight:d})}if("requestPreviewConfig"===i&&this.sendMessage("sendConfig",this.previewConfig),"loadSuccess"===i&&this.spinner){var m="".concat(n,"Form"),g=this[m]&&this[m].removeChild;g&&this[m].removeChild(this.spinner),this.spinner=null,this.overlay&&(g&&this[m].removeChild(this.overlay),this.overlay=null)}if("resizeForm"===i){var f=n.width,v=n.height,y=this.getFormType(),b=document.documentElement.clientHeight||window.innerHeight,w=this.checkMobileDevice();if(this.formHeight=b,p("resizeForm",f,"x",v),1===y)return void(v>=b&&(this.iframe.style.height="".concat(v,"px")));if(w||(this.iframe.style.width="".concat(f,"px")),this.iframe.style.height="".concat(v,"px"),this.campaign){var k=this.campaign,x=k.type,S=k.position,C=0===S.indexOf("upper"),F=this.campaignForm.classList.contains(S);if(v>=b&&(this.iframe.style.height="".concat(v,"px")),2===x&&S&&!F&&this.campaignForm.classList.add(S),2===x&&C){var I=parseInt((b-v)/2);this.campaignForm.style.top=v>=b?"0px":"".concat(I,"px")}}}"showPreview"===i&&this.checkPreviewMode()&&(this.previewConfig=n,this.showPreview()),"remove"===i&&this.checkPreviewMode()&&(window._uxsSettings=null,this.outer&&(this.outer.parentNode.removeChild(this.outer),this.outer=null,this.iframe=null,this.campaignForm=null,this.styles.clear(),window.removeEventListener("message",this.messageListenerFn,!0))),"callYaMetrica"===i&&this.reachYaMetricaGoal(n)}},{key:"reachYaMetricaGoal",value:function(e){var t=e.id,i=e.params;if(p("callYaMetrica",t,i),t){var n=window.ym,r=window["yaCounter"+t];n?n(t,"reachGoal","UX_FEEDBACK",i):r&&r.reachGoal("UX_FEEDBACK",i)}}},{key:"sendMessage",value:function(e,t){this.iframe&&this.iframe.contentWindow&&this.iframe.contentWindow.postMessage&&this.iframe.contentWindow.postMessage({type:e,payload:t},"*")}},{key:"messageListenerFn",value:function(e){return this.receiveMessage(e)}},{key:"initListener",value:function(){this.initedListener||(this.initedListener=!0,window.addEventListener("message",this.messageListenerFn,!0))}},{key:"loadForm",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.initListener(),this.clearCampaign(),"widget"===e?(this.widgetForm=this.createForm("widget"),this.overlay=this.createOverlay(),this.overlay.onclick=function(e){e.stopPropagation(),t.closeWidgetForm()},this.widgetForm.appendChild(this.overlay),this.outer.appendChild(this.widgetForm)):(this.campaign=r()({},i),this.campaignForm=this.createForm("campaign"),this.outer.appendChild(this.campaignForm)),window.addEventListener("resize",m(this.onResize,300),!1),this.iframe.focus()}},{key:"onResize",value:function(){if(!("popup"===this.getFormType())){var e=document.documentElement.clientHeight||window.innerHeight;if(this.formHeight!==e&&this.sendMessage("sendInfo",{innerHeight:e}),this.campaign){var t=this.campaign,i=t.type,n=0===t.position.indexOf("upper"),r=this.iframe.clientHeight,o=window.innerHeight||document.documentElement.clientHeight;if(2===i&&n){var s=parseInt((o-r)/2);this.campaignForm.style.top=r>=o?"0px":"".concat(s,"px")}}}}},{key:"clearCampaign",value:function(){this.campaign=null}},{key:"createImage",value:function(e){var t=this,i=document.createElement("img");return i.onclick=function(){return t.loadForm("widget")},i.onload=function(){var e=Math.floor(i.naturalWidth/2);i.style.setProperty("width","".concat(e,"px"),"important"),i.setAttribute("width",e)},i.style.width="50%",i.style.height="auto",i.src=e,i}},{key:"checkMobileDevice",value:function(){return this.device.mobile||this.device.tablet}},{key:"shouldRenderDesktop",value:function(){return!this.checkMobileDevice()&&this.state.hasOwnProperty("position")&&this.state.position>0}},{key:"shouldRenderMobile",value:function(){var e=this.state.mobile;return this.checkMobileDevice()&&e&&e.position>0}},{key:"shouldRender",value:function(){return this.shouldRenderDesktop()||this.shouldRenderMobile()}},{key:"processRenderWidget",value:function(e){var t=this,i=this.state.targeting,n=i&&i.seconds&&i.seconds.value||1;i&&i.session?this.startSessionInterval(i.session.value,(function(){t.mergeIntervalTargeting(i,(function(){return e()}),n)})):i&&i.scrollPage&&!this.targetingScrollPercent?this.setScrollPage(i.scrollPage.value,(function(){t.widgetRenderTimeout=setTimeout((function(){e(),clearTimeout(t.widgetRenderTimeout),t.widgetRenderTimeout=null}),1e3*n)})):i&&i.seconds?this.widgetRenderTimeout=setTimeout((function(){e(),clearTimeout(t.widgetRenderTimeout),t.widgetRenderTimeout=null}),1e3*n):e()}},{key:"renderDesktopWidget",value:function(){var e=this.state.image,t=this.createImage(e);this.wrapper=this.createWrapper(),this.wrapper.appendChild(t)}},{key:"renderMobileWidget",value:function(){var e=this.state.mobile,t=this.createImage(e.image);this.mobileWrapper=this.createMobileWrapper(),this.mobileWrapper.appendChild(t)}},{key:"clearCampaignTimeout",value:function(){clearTimeout(this.campaignTimeout),this.campaignTimeout=null}},{key:"clearWidgetRenderTimeout",value:function(){null!==this.widgetRenderTimeout&&(clearTimeout(this.widgetRenderTimeout),this.widgetRenderTimeout=null)}},{key:"destroyDesktopWidget",value:function(){this.clearWidgetRenderTimeout(),this.wrapper&&(this.outer.removeChild(this.wrapper),this.wrapper=null)}},{key:"destroyMobileWidget",value:function(){this.clearWidgetRenderTimeout(),this.mobileWrapper&&(this.outer.removeChild(this.mobileWrapper),this.mobileWrapper=null)}},{key:"render",value:function(){var e=this.shouldRenderDesktop(),t=this.shouldRenderMobile();e&&this.processRenderWidget(this.renderDesktopWidget),t&&this.processRenderWidget(this.renderMobileWidget)}},{key:"processSecondsCampaign",value:function(e,t){var i=this,n=e._id,o=e.type,s=e.position,a=e.targeting,l=r()({},this.campaign,{id:n,type:o,position:s}),c=a&&a.trigger;c&&"session"===c.mode&&this.removeEventFromStorage(c.value),this.campaignForm||(this.campaignTimeout=setTimeout((function(){p("start campaign after",t,"seconds",l),i.clearCampaignTimeout(),i.widgetForm||i.loadForm("campaign",l)}),1e3*t))}},{key:"onUnloadListener",value:function(e){var t=this.state.campaigns,i=void 0===t?[]:t;e.clientY<10&&(this.processSecondsCampaign(i[0],1),window.removeEventListener("mousemove",this.onUnloadListener))}},{key:"scrollPageListener",value:function(){var e=document.documentElement.scrollHeight;(e-(e-document.documentElement.clientHeight-document.documentElement.scrollTop))/e*100>=this.targetingScrollPercent&&(this.scrollFn(),this.removeScrollPage())}},{key:"removeScrollPage",value:function(){window.removeEventListener("scroll",this.scrollPageListener),this.targetingScrollPercent=null,this.scrollFn=null}},{key:"setScrollPage",value:function(e,t){this.targetingScrollPercent=e,this.scrollFn=t,window.addEventListener("scroll",this.scrollPageListener)}},{key:"startSessionInterval",value:function(e,t){var i=this;this.sessionInterval=+window.sessionStorage.getItem("UXS_interval"),this.sessionInterval||(this.sessionInterval=0),this.campaignSessionInterval=setInterval((function(){i.sessionInterval+=3,window.sessionStorage.setItem("UXS_interval",i.sessionInterval),i.sessionInterval>+e&&(t(),clearInterval(i.campaignSessionInterval),i.campaignSessionInterval=null,window.sessionStorage.removeItem("UXS_interval"))}),3e3)}},{key:"mergeIntervalTargeting",value:function(e,t,i){var n=this,r=e.onunload,o=e.scrollPage;r?setTimeout((function(){window.addEventListener("mousemove",n.onUnloadListener)}),1e3*i):o&&!this.targetingScrollPercent?this.setScrollPage(o.value,(function(){return t()})):t()}},{key:"startTriggetCampaign",value:function(e,t,i,n){var r=this,o="session"===i.targeting.trigger.mode;t.includes(e)?(this.startSessionInterval(n,(function(){return r.processSecondsCampaign(i,1)})),o||this.state.spa&&this.state.spa.on||(this.removeEventFromStorage(e),window.sessionStorage.removeItem("UXS_interval"))):console.log("Undefined event - ".concat(t))}},{key:"removeEventFromStorage",value:function(e){var t=window.sessionStorage.getItem("UXS_event");t&&window.sessionStorage.setItem("UXS_event",t.split(",").filter((function(t){return t!==e})).join(","))}},{key:"subscriber",value:function(e,t,i){var n=this;return function(r){n.campaignForm?(n.removeEventFromStorage(e),window.UXS.subscribe("event",e,n.subscriber(e,t,i))):n.startTriggetCampaign(e,r,t,i)}}},{key:"processCampaigns",value:function(){var e=this,t=this.state.campaigns,i=void 0===t?[]:t,n=i.length;if(!n)return!1;for(var o=function(t){var n=i[t],o=n.targeting,s=o.seconds,a=o.trigger,l=o.onunload,c=o.session,u=o.scrollPage,d=a&&a.seconds,h=s&&s.enabled?s.value:1;if(p("proccess campaign",t,n),e.campaign=r()({},x),c)return e.startSessionInterval(c.value,(function(){e.mergeIntervalTargeting({onunload:l,scrollPage:u},(function(){return e.processSecondsCampaign(n,h)}),h)})),"break";if(l)return setTimeout((function(){window.addEventListener("mousemove",e.onUnloadListener)}),1e3*h),"break";if(u&&!e.targetingScrollPercent)return e.setScrollPage(u.value,(function(){return e.processSecondsCampaign(n,h)})),"break";if(!a)return e.processSecondsCampaign(n,h),"break";var m=a.value,g="session"===a.mode,f=window.sessionStorage.getItem("UXS_event");f&&(f=f.split(",")),f&&f.includes(m)&&g&&!e.campaignSessionInterval?e.startSessionInterval(d,(function(){return e.processSecondsCampaign(n,1)})):window.UXS.subscribe("event",m,e.subscriber(m,n,d))},s=0;s<n;s++){if("break"===o(s))break}}},{key:"prerender",value:function(){this.styles=new g,this.styles.addCommon(),this.outer=this.createOuter()}},{key:"checkPreviewMode",value:function(){return window._uxsSettings&&window._uxsSettings.isPreview}},{key:"showPreview",value:function(){this.campaign=r()({},x,this.previewConfig),this.loadForm("campaign",this.campaign)}},{key:"postText",value:function(e,t,i,n){var r=new XMLHttpRequest;r.open("POST",e,!0),r.setRequestHeader("Content-Type","text/plain; charset=UTF-8"),this.post(r,t,i,n)}},{key:"postJSON",value:function(e,t,i,n){var r=new XMLHttpRequest;r.open("POST",e,!0),r.setRequestHeader("Content-Type","application/json; charset=UTF-8"),r.setRequestHeader("Accept","application/json"),this.post(r,t,i,n)}},{key:"post",value:function(e,t,i,n){e.send(JSON.stringify(t)),e.onerror=function(){n&&n(null,0)},e.onload=function(){var t=e.status;try{var r=JSON.parse(e.response);t>=200&&t<400?i&&i(r,t):t>=400&&n&&n(r,t)}catch(t){console.error("JSON Error",t,e)}}}},{key:"saveVisit",value:function(e){var t=this.getSiteId(),i={uid:this.uid,userId:t,campaignId:e};this.postJSON("".concat(k.API_URL,"/visits"),i)}},{key:"loadData",value:function(e,t){this.isFetching=!0;var i=this.uid,n=this.uidType,r=this.getSiteId(),o="".concat(k.API_URL,"/widgets/").concat(r,"?uid=").concat(i,"&uidType=").concat(n),s={url:document.location.href,cookies:document.cookie};this.postJSON(o,s,e,t)}},{key:"getDomainName",value:function(){var e=document.location.hostname,t=e.match(/([^.]{1,}\.[^.]{1,})$/i);return null===t?e:t[0]}},{key:"getUid",value:function(){return u.a.get("uxs_uid")}},{key:"createUid",value:function(){var e=h()();return this.setUid(e),e}},{key:"setUid",value:function(e){var t=this.getDomainName();u.a.set("uxs_uid",e,{expires:730,domain:t})}},{key:"createMigrationCookie",value:function(){var e=this.getDomainName();u.a.set("uxs_mig",1,{expires:31,domain:e})}},{key:"checkUid",value:function(){var e=this.getUid();e?(this.uid=e,this.uidType="old",u.a.get("uxs_mig")||(u.a.remove("uxs_uid"),this.setUid(e),this.createMigrationCookie())):(this.uid=this.createUid(),this.uidType="new",this.createMigrationCookie())}},{key:"loadFonts",value:function(){var e=this.state.font;if(e){var t=e.external,i=e.src,n=t?"link":"style",r=document.createElement(n),o=document.getElementsByTagName("head")[0];if(r.id="uxs-fonts",t)return r.setAttribute("rel","stylesheet"),r.setAttribute("href",i),void o.appendChild(r);r.appendChild(document.createTextNode(i)),o.appendChild(r)}}},{key:"getHashListener",value:function(){var e=r()({},window.location),t=this.hashListener;return function(){t.call(this,arguments,e)}}},{key:"hashListener",value:function(e,t){this.isFetching||this.updateWidgetData(t)}},{key:"initLocationListener",value:function(){var e=window,t=e.history,i=e.addEventListener,n=e.location,o=this.state.spa,s=o&&o.hash,a=t.pushState,l=this.updateWidgetData,c=this.getHashListener();s&&i("hashchange",c,!1),t.pushState=function(){for(var e=r()({},n),i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];a.apply(t,o),l(e)}}},{key:"updateWidgetData",value:function(e){var t=this,i=this.state.spa,n=window.location,r=n.hash,o=n.pathname,s=n.search,a=e.pathname!==o,l=i&&i.qp&&e.search!==s,c=e.hash!==r;if(a||l||c){this.clearCampaignTimeout();var u=sessionStorage.getItem("UXS_event");if(u){var d=this.state.campaigns,h=(void 0===d?[]:d).filter((function(e){var t=e.targeting;return t&&t.trigger})).filter((function(e){return"page"===e.targeting.trigger.mode})).find((function(e){return e.targeting.trigger.value===u}));h&&(clearInterval(this.campaignSessionInterval),this.campaignSessionInterval=null,this.removeEventFromStorage(h.targeting.trigger.value),this.sessionInterval=0,sessionStorage.removeItem("UXS_interval"))}this.campaignForm&&this.closeCampaignForm(),this.loadData((function(e){t.isFetching=!1;var i=t.state,n=i.position,r=i.mobile,o=void 0===r?{}:r;t.state=e,t.checkWidgetRender(n,o.position),t.processCampaigns()}),(function(e,i){t.isFetching=!1,p("loadData error",i,e)}))}}},{key:"checkWidgetRender",value:function(e,t){var i=this,n=this.state,r=n.mobile,o=n.position,s=!this.checkMobileDevice()&&e!==o,a=t!==(r&&r.position);if(s)(this.shouldRenderDesktop()?function(){return i.processRenderWidget(i.renderDesktopWidget)}:this.destroyDesktopWidget)();else if(a){(this.shouldRenderMobile()?function(){return i.processRenderWidget(i.renderMobileWidget)}:this.destroyMobileWidget)()}}},{key:"start",value:function(){var e=this;this.device=w(),this.checkPreviewMode()?(this.prerender(),this.initListener()):(this.checkUid(),this.loadData((function(t){e.isFetching=!1,e.state=t;var i=void 0!==t.error,n=!!t.campaigns,r=!i&&null!==e.state&&e.shouldRender()&&!e.checkPreviewMode(),o=t.spa&&Number(t.spa.on);(n||r||o)&&(e.prerender(),e.processCampaigns()),o&&e.initLocationListener(),r&&(e.render(),e.loadFonts())}),(function(t,i){e.isFetching=!1,p("loadData error",i,t)})))}}]),e}(),C=i("RIqP"),F=i.n(C),I=function(){function e(){s()(this,e),this.events={}}return l()(e,[{key:"sendEvent",value:function(e){var t=this.events.event,i=sessionStorage.getItem("UXS_event"),n=i&&i.split(",").filter(Boolean).length;if(!(t&&t[0]&&n)&&(i?sessionStorage.setItem("UXS_event",[e].concat(F()(i.split(",").filter((function(t){return t!==e})))).join(",")):sessionStorage.setItem("UXS_event",e),t&&t[0])){var r=t.findIndex((function(t){return t[0]===e}));t[-1===r?0:r][1](e),this.events.event=this.events.event.filter((function(e,t){return t!==r}))}}},{key:"subscribe",value:function(e,t,i){p("subscribe type:",e,t,i),this.events[e]||(this.events[e]=[]);var n=this.events[e],r=n.findIndex((function(e){return e[0]===t}));this.events[e]=n.filter((function(e,t){return t!==r})),this.events[e].push([t,i])}}]),e}();!function(){window._uxsSettings||(window._uxsSettings={});var e=/Trident|MSIE/.test(navigator.userAgent),t="5b97522f8a70c35a8534b4b0"===window._uxsSettings.id;e&&t||(window.UXS=new I,(new S).start())}()},xDdU:function(e,t,i){var n,r,o=i("4fRq"),s=i("I2ZF"),a=0,l=0;e.exports=function(e,t,i){var c=t&&i||0,u=t||[],d=(e=e||{}).node||n,h=void 0!==e.clockseq?e.clockseq:r;if(null==d||null==h){var p=o();null==d&&(d=n=[1|p[0],p[1],p[2],p[3],p[4],p[5]]),null==h&&(h=r=16383&(p[6]<<8|p[7]))}var m=void 0!==e.msecs?e.msecs:(new Date).getTime(),g=void 0!==e.nsecs?e.nsecs:l+1,f=m-a+(g-l)/1e4;if(f<0&&void 0===e.clockseq&&(h=h+1&16383),(f<0||m>a)&&void 0===e.nsecs&&(g=0),g>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=m,l=g,r=h;var v=(1e4*(268435455&(m+=122192928e5))+g)%4294967296;u[c++]=v>>>24&255,u[c++]=v>>>16&255,u[c++]=v>>>8&255,u[c++]=255&v;var y=m/4294967296*1e4&268435455;u[c++]=y>>>8&255,u[c++]=255&y,u[c++]=y>>>24&15|16,u[c++]=y>>>16&255,u[c++]=h>>>8|128,u[c++]=255&h;for(var b=0;b<6;++b)u[c+b]=d[b];return t||s(u)}}});